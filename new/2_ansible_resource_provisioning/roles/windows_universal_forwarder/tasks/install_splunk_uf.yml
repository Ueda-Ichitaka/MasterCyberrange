

# - name: Download Splunk UF from Splunk website
#   win_shell: |
#     [Net.ServicePointManager]::SecurityProtocol = "tls12, tls11, tls"
#     (New-Object System.Net.WebClient).DownloadFile("{{ splunk_uf_win_url }}", "C:\splunkuf.msi")


# pfad auf proxy, f√ºr von host aus muss der pfad wieder angepasst werden
- name: copy splunk installer
  ansible.builtin.copy:
    src: /home/2_ansible_resource_provisioning/remote_host_files/splunk/splunkforwarder-9.2.1-78803f08aabb-x64-release.msi
    dest: C:\splunkuf.msi
    owner: '{{ ansible_user }}'
    group: '{{ ansible_user }}'
    mode: '744'



- name: Install Splunk_UF MSI
  win_package:
    path: C:\splunkuf.msi
    arguments: 'WINEVENTLOG_SEC_ENABLE=0 WINEVENTLOG_SYS_ENABLE=0 WINEVENTLOG_APP_ENABLE=0 SPLUNKPASSWORD=Pl3ase-k1Ll-me:p AGREETOLICENSE=YES /quiet'

- name: Start Splunk
  win_service:
    name: SplunkForwarder
    state: started
